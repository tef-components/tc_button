<link rel="import" href="bower_components/polymer/polymer.html">

<polymer-element name="tef-button" on-click="{{onClick}}" attributes ="label size type toggle active disabled">
    <template>  
    	<tef-core id="core" ></tef-core>  	
	    <link rel="stylesheet" href="bower_components/buttons/css/buttons.min.css">	    
		<button id="button" class ="tef-button {{size}} {{type}}">
		    {{label}}
		</button>
	</template>
	<script>
		function hasClass(ele,cls) {
			return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
		}
		 
		function addClass(ele,cls) {
			if (!this.hasClass(ele,cls)) ele.className += " "+cls;
		}
		 
		function removeClass(ele,cls) {
			if (hasClass(ele,cls)) {
		    	var reg = new RegExp(' (\\s|^)'+cls+'(\\s|$)');
				ele.className=ele.className.replace(reg,' ');
			}
		}
		Polymer({			
			label: "Button",
			size: "",
			type: "",
			brand :"",
			publish: {
				toggle:{
					value: false,
					reflect: true
				},
				active:{
					value: false,
					reflect: true
				},
				disabled:{
					value:false,
					reflect: true
				}
			},

			activeChanged: function(oldValue, newValue){
				var button = this.$.button;
				if (newValue){
					addClass(button, "active");					
					this.fire("activated");
				}else{
					removeClass(button, "active")					
					this.fire("deactivated");
				}
			},
			
			disabledChanged: function(oldValue, newValue) {
				var button = this.$.button;
				if (newValue) addClass(button, "disabled");
				else removeClass(button, "disabled");
			},

			onClick: function(){
				if (!this.disabled) {
					if (this.toggle){
						var button = this.$.button;
						this.active = !this.active;
					}else{
						this.fire("clicked");//Could be pressed						
					}
				}
			},
			ready: function(){
				this.$.core.addEventListener("ready", function(){
					var href = "bower_components/buttons/css/buttons." + this.$.core.brand +".min.css";
					this.addDinamicCss(href);
				}.bind(this));
				
			},
			addDinamicCss: function(href){
				var link = document.createElement('link');
				link.type = 'text/css';
				link.rel = 'stylesheet';
				link.href = href;
				this.shadowRoot.appendChild(link);
				this.element.convertSheetsToStyles(this.shadowRoot); 
			}	
		});
	</script>	
</polymer-element>