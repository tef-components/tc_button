<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/core-ajax/core-ajax.html">
<link rel="import" href="bower_components/core-signals/core-signals.html">

<polymer-element name="tef-button" attributes ="size type toggle active disabled" on-click="{{onClick}}">
    <template>
	    <link rel="stylesheet" href="bower_components/buttons/css/buttons.min.css">
        <button id="button" class ="tef-button{{size ? ' '+size : ''}}{{type ? ' '+type : ''}}{{disabled ? ' disabled' : ''}}{{toggle && active && !disabled ?  ' active' : ''}}">
		    <content></content>
        </button>
        <core-signals on-core-signal-new-brand="{{newBrand}}"></core-signals>
        <template if={{brand}}>
            <core-ajax url="bower_components/buttons/css/buttons.{{brand}}.min.css" auto response="{{resp}}"></core-ajax>
            <style>{{resp}}</style>
        </template>
	</template>
	<script>
		Polymer({ 
            brand : "",
            
			publish: {
				toggle: {
					value: false,
					reflect: true
				},
				active: {
					value: false,
					reflect: true
				},
				disabled: {
					value: false,
					reflect: true
				}
			},
            
            activeChanged: function(oldValue, newValue){
				var button = this.$.button;
				if (newValue){					
					this.fire("activated");
				} else {				
					this.fire("deactivated");
				}
			},
            
            newBrand: function(e, detail, sender) {
                cpy = "";
                if (detail != 'telefonica') {
                    cpy = detail;
                }
                this.brand = cpy;
            },

			onClick: function(){
				if (!this.disabled) {
					if (this.toggle){
						this.active = !this.active;
					} else {
						this.fire("clicked"); //Could be pressed						
					}
				}
			},
            
		});
	</script>	
</polymer-element>
