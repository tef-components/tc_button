<<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-style/core-style.html">
<link rel="import" href="../buttons/tef_button.html">

<polymer-element name="tef-button" attributes ="size type disabled toggle active" on-click="{{onClick}}">
    <template>
        <core-style ref="tef-button"></core-style>
        <div id="button" class="{{resolveClass(active)}}">
            <content></content>
        </div>
    </template>
    <script>
        Polymer({
            publish: {
                active: {
                    value: false,
                    reflect: true
                },
                disabled: {
                    value: false,
                    reflect: true
                },
                toggle: {
                    value: false,
                    reflect: true
                }
            },

            activeChanged: function(oldValue, newValue) {
                if (newValue) {
                    this.active = newValue;
                }
            },

            disabledChanged: function(oldValue, newValue) {
                if (newValue) {
                    this.disabled = newValue;
                }
            },

            toggleChanged: function(oldValue, newValue) {
                if (newValue) {
                    this.toggle = newValue;
                }
            },

            onClick: function() {
                if (!this.disabled) {
                    if (this.toggle) {
                        this.active = !this.active;
                        if (this.active) {
                            this.fire('inside-click', {msg: 'toggle-on'});
                        } else {
                            this.fire('inside-click', {msg: 'toggle-off'});
                        }
                    } else {
                        this.fire('inside-click', {msg: 'clicked'});
                    }
                }
            },

            resolveClass: function(value) {
                var localClass = 'tef-button';
                if (this.size) localClass += ' ' + this.size;
                if (this.type) localClass += ' ' + this.type;
                if (this.disabled) {
                    localClass += ' disabled';
                } else {
                    if (this.toggle && this.active)
                        localClass += ' active';
                }
                return localClass;
            }

        });
    </script>
</polymer-element>